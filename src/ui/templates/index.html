<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ i18n["title"] }}</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <header>
    <div class="brand">
      <h1>{{ i18n["title"] }}</h1>
      <div class="badge-row">
        <span class="mode">{{ i18n["mode_label"].format(mode=i18n["modes"].get(mode, mode|upper)) }}</span>
        {% if mock_mode %}
          <span class="badge warning">{{ i18n["mock_mode_banner"] }}</span>
        {% endif %}
      </div>
    </div>
    <nav>
      <a href="#dashboard">{{ i18n["nav_dashboard"] }}</a>
      <a href="#watchlist">{{ i18n["nav_watchlist"] }}</a>
      <a href="#analyze">{{ i18n["nav_analyze"] }}</a>
      <a href="#risk">{{ i18n["nav_risk"] }}</a>
      <a href="#funding">{{ i18n["nav_funding"] }}</a>
      <a href="#backtest">{{ i18n["nav_backtest"] }}</a>
      <a href="#model-center">{{ i18n["nav_model_center"] }}</a>
      <a href="#test-center">{{ i18n["nav_test_center"] }}</a>
      <a href="#logs">{{ i18n["nav_logs"] }}</a>
    </nav>
  </header>

  <main>
    <section id="dashboard" class="panel">
      <h2>{{ i18n["dashboard_title"] }}</h2>
      <div class="grid">
        <div>
          <h3>{{ i18n["quick_status_title"] }}</h3>
          <ul>
            <li>{{ i18n["default_watchlist_size"].format(count=watchlist|length) }}</li>
            <li>{{ i18n["max_open_positions"].format(count=risk.max_open_positions) }}</li>
            <li>{{ i18n["cash_buffer"].format(percent=(risk.cash_buffer * 100)|round(1)) }}</li>
          </ul>
        </div>
        <div>
          <h3>{{ i18n["actions_title"] }}</h3>
          <button type="button" id="refresh-tests">{{ i18n["run_test_center_button"] }}</button>
          <button type="button" id="start-orchestrator">{{ i18n["start_button"] }}</button>
          <button type="button" id="pause-orchestrator">{{ i18n["pause_button"] }}</button>
          <button type="button" id="stop-orchestrator">{{ i18n["stop_button"] }}</button>
        </div>
      </div>
    </section>

    <section id="watchlist" class="panel">
      <h2>{{ i18n["watchlist_title"] }}</h2>
      <p>{{ i18n["watchlist_desc"] }}</p>
      <div class="tags">
        {% for symbol in watchlist %}
          <span>{{ symbol }}</span>
        {% endfor %}
      </div>
      <div class="form-block">
        <label for="watchlist-input">{{ i18n["bulk_paste_label"] }}</label>
        <textarea id="watchlist-input" rows="4" placeholder="{{ i18n["bulk_paste_placeholder"] }}"></textarea>
        <button type="button" id="save-watchlist">{{ i18n["save_watchlist_button"] }}</button>
        <div id="watchlist-status" class="helper-text"></div>
      </div>
    </section>

    <section id="analyze" class="panel">
      <h2>{{ i18n["analyze_title"] }}</h2>
      <p>{{ i18n["analyze_desc"] }}</p>
      <div class="form-block">
        <label for="analyze-input">{{ i18n["analyze_label"] }}</label>
        <input id="analyze-input" type="text" placeholder="{{ i18n["analyze_placeholder"] }}" />
        <div class="button-row">
          <button type="button" id="analyze-selected">{{ i18n["analyze_selected_button"] }}</button>
          <button type="button" id="analyze-all">{{ i18n["analyze_all_button"] }}</button>
        </div>
        <div id="analyze-status" class="helper-text"></div>
      </div>
    </section>

    <section id="risk" class="panel">
      <h2>{{ i18n["risk_title"] }}</h2>
      <ul>
        <li>{{ i18n["risk_per_trade"].format(percent=(risk.risk_per_trade * 100)|round(2)) }}</li>
        <li>{{ i18n["max_position_weight"].format(percent=(risk.max_position_weight * 100)|round(1)) }}</li>
        <li>{{ i18n["weekly_drawdown"].format(percent=(risk.weekly_max_drawdown * 100)|round(1)) }}</li>
      </ul>
    </section>

    <section id="funding" class="panel">
      <h2>{{ i18n["funding_title"] }}</h2>
      <p>{{ i18n["funding_desc"] }}</p>
      <div id="funding-alerts" class="stacked-list"></div>
    </section>

    <section id="backtest" class="panel">
      <h2>{{ i18n["backtest_title"] }}</h2>
      <p>{{ i18n["backtest_desc"] }}</p>
      <div class="form-block">
        <label for="backtest-symbols">{{ i18n["backtest_symbols_label"] }}</label>
        <input id="backtest-symbols" type="text" placeholder="{{ i18n["backtest_symbols_placeholder"] }}" />
        <div class="button-row">
          <input id="backtest-years" type="number" min="1" value="5" />
          <input id="backtest-train-days" type="number" min="20" value="504" />
          <input id="backtest-test-days" type="number" min="10" value="126" />
          <input id="backtest-step-days" type="number" min="5" value="63" />
        </div>
        <button type="button" id="backtest-run">{{ i18n["backtest_button"] }}</button>
        <pre id="backtest-results" class="helper-text"></pre>
      </div>
    </section>

    <section id="model-center" class="panel">
      <h2>{{ i18n["model_center_title"] }}</h2>
      <p>{{ i18n["model_center_desc"] }}</p>
      <div class="form-block">
        <div class="button-row">
          <button type="button" id="model-list">{{ i18n["model_center_list"] }}</button>
          <button type="button" id="model-active">{{ i18n["model_center_active"] }}</button>
        </div>
        <label for="model-id">{{ i18n["model_center_set_label"] }}</label>
        <input id="model-id" type="text" placeholder="model-YYYYMMDDHHMMSS" />
        <button type="button" id="model-set-active">{{ i18n["model_center_set_button"] }}</button>
        <label for="model-drift-baseline">{{ i18n["model_center_drift_baseline"] }}</label>
        <textarea id="model-drift-baseline" rows="3" placeholder='[{"feature": 1}]'></textarea>
        <label for="model-drift-current">{{ i18n["model_center_drift_current"] }}</label>
        <textarea id="model-drift-current" rows="3" placeholder='[{"feature": 2}]'></textarea>
        <button type="button" id="model-drift-check">{{ i18n["model_center_drift_button"] }}</button>
        <label for="model-shadow-features">{{ i18n["model_center_shadow_features"] }}</label>
        <textarea id="model-shadow-features" rows="3" placeholder="[[1, 2], [2, 3]]"></textarea>
        <label for="model-shadow-target">{{ i18n["model_center_shadow_target"] }}</label>
        <textarea id="model-shadow-target" rows="2" placeholder="[0, 1]"></textarea>
        <label for="model-shadow-candidate">{{ i18n["model_center_shadow_candidate"] }}</label>
        <input id="model-shadow-candidate" type="text" placeholder="candidate-model-id" />
        <label for="model-shadow-active">{{ i18n["model_center_shadow_active"] }}</label>
        <input id="model-shadow-active" type="text" placeholder="active-model-id (optional)" />
        <button type="button" id="model-shadow-test">{{ i18n["model_center_shadow_button"] }}</button>
        <pre id="model-center-results" class="helper-text"></pre>
      </div>
    </section>

    <section id="test-center" class="panel">
      <h2>{{ i18n["test_center_title"] }}</h2>
      <p>{{ i18n["test_center_desc"] }}</p>
      <div id="test-results">{{ i18n["test_center_default"] }}</div>
    </section>

    <section id="logs" class="panel">
      <h2>{{ i18n["logs_title"] }}</h2>
      <p>{{ i18n["logs_desc"] }}</p>
      <div id="log-box" class="log-box">{{ i18n["logs_empty"] }}</div>
    </section>
  </main>

  <footer>
    <span>{{ i18n["footer"] }}</span>
  </footer>

  <script>
    window.I18N = {{ i18n | tojson }};
  </script>
  <script src="/static/app.js"></script>
</body>
</html>
