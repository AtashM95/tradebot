<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ultimate Trading Bot v2</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <header>
    <div class="brand">
      <h1>Ultimate Trading Bot v2</h1>
      <span class="mode">Mode: {{ mode|upper }}</span>
    </div>
    <nav>
      <a href="#dashboard">Dashboard</a>
      <a href="#watchlist">Watchlist</a>
      <a href="#analyze">Analyze</a>
      <a href="#risk">Risk</a>
      <a href="#funding">Funding Alerts</a>
      <a href="#backtest">Backtest</a>
      <a href="#model-center">Model Center</a>
      <a href="#test-center">Test Center</a>
      <a href="#logs">Logs</a>
    </nav>
  </header>

  <main>
    <section id="dashboard" class="panel">
      <h2>Dashboard</h2>
      <div class="grid">
        <div>
          <h3>Quick Status</h3>
          <ul>
            <li>Default watchlist size: {{ watchlist|length }}</li>
            <li>Max open positions: {{ risk.max_open_positions }}</li>
            <li>Cash buffer: {{ (risk.cash_buffer * 100)|round(1) }}%</li>
          </ul>
        </div>
        <div>
          <h3>Actions</h3>
          <button type="button" id="refresh-tests">Run Test Center</button>
          <button type="button" disabled>Start</button>
          <button type="button" disabled>Pause</button>
          <button type="button" disabled>Stop</button>
        </div>
      </div>
    </section>

    <section id="watchlist" class="panel">
      <h2>Watchlist</h2>
      <p>Bulk paste symbols (100–200 US equities). Current default:</p>
      <div class="tags">
        {% for symbol in watchlist %}
          <span>{{ symbol }}</span>
        {% endfor %}
      </div>
    </section>

    <section id="analyze" class="panel">
      <h2>Analyze</h2>
      <p>Run price action gate, strategy ensemble, and risk filters.</p>
      <button type="button" disabled>Analyze Selected</button>
      <button type="button" disabled>Analyze All</button>
    </section>

    <section id="risk" class="panel">
      <h2>Risk</h2>
      <ul>
        <li>Risk per trade: {{ (risk.risk_per_trade * 100)|round(2) }}%</li>
        <li>Max position weight: {{ (risk.max_position_weight * 100)|round(1) }}%</li>
        <li>Weekly drawdown limit: {{ (risk.weekly_max_drawdown * 100)|round(1) }}%</li>
      </ul>
    </section>

    <section id="funding" class="panel">
      <h2>Funding Alerts</h2>
      <p>Cash shortfall handling: swap/trim → partial entry → trade queue (TTL).</p>
      <div class="alert">No active funding alerts.</div>
    </section>

    <section id="backtest" class="panel">
      <h2>Backtest</h2>
      <p>5-year walk-forward backtest with latest holdout period.</p>
      <button type="button" disabled>Run Backtest</button>
    </section>

    <section id="model-center" class="panel">
      <h2>Model Center</h2>
      <p>MLOps-lite: drift monitor, incremental updates, registry, shadow tests.</p>
      <button type="button" disabled>Open Registry</button>
    </section>

    <section id="test-center" class="panel">
      <h2>Test Center</h2>
      <p>System checks for account, data, dry-run, orders, funding alerts, backtest.</p>
      <div id="test-results">Click "Run Test Center" to fetch results.</div>
    </section>

    <section id="logs" class="panel">
      <h2>Logs</h2>
      <p>Structured logs will appear here.</p>
      <div class="log-box">No logs yet.</div>
    </section>
  </main>

  <footer>
    <span>Ultimate Trading Bot v2 — US equities only, long-only swing.</span>
  </footer>

  <script src="/static/app.js"></script>
</body>
</html>
